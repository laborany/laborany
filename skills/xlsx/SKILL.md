---
name: Excelè¡¨æ ¼åŠ©æ‰‹
description: |
  åˆ›å»ºã€ç¼–è¾‘å’Œåˆ†æç”µå­è¡¨æ ¼ï¼ˆ.xlsxï¼‰ï¼Œæ”¯æŒå…¬å¼è®¡ç®—ã€æ•°æ®åˆ†æå’Œå›¾è¡¨å¯è§†åŒ–ã€‚
  è§¦å‘åœºæ™¯:
  (1) ç”¨æˆ·éœ€è¦åˆ›å»ºæ–°çš„ Excel è¡¨æ ¼
  (2) ç”¨æˆ·éœ€è¦ç¼–è¾‘æˆ–ä¿®æ”¹ç°æœ‰ .xlsx æ–‡ä»¶
  (3) ç”¨æˆ·éœ€è¦è¿›è¡Œæ•°æ®åˆ†æã€é€è§†è¡¨ã€å›¾è¡¨åˆ¶ä½œ
  (4) ç”¨æˆ·è¯¢é—®"å¸®æˆ‘åšä¸ªè¡¨æ ¼"ã€"æ•°æ®åˆ†æ"ã€"Excelå¤„ç†"
  æ”¯æŒ: è´¢åŠ¡æŠ¥è¡¨ã€æ•°æ®ç»Ÿè®¡ã€åº“å­˜ç®¡ç†ã€é¡¹ç›®è·Ÿè¸ªç­‰åœºæ™¯
icon: ğŸ“ˆ
category: åŠå…¬
---

# XLSX ç”µå­è¡¨æ ¼å¤„ç†

## æ¦‚è¿°

å¤„ç† Excel ç”µå­è¡¨æ ¼ï¼ˆ.xlsxï¼‰çš„åˆ›å»ºã€ç¼–è¾‘å’Œåˆ†æã€‚æ”¯æŒå…¬å¼è®¡ç®—ã€æ•°æ®é€è§†ã€å›¾è¡¨ç”Ÿæˆã€‚

## å·¥ä½œæµå†³ç­–æ ‘

### åˆ›å»ºæ–°è¡¨æ ¼
ä½¿ç”¨ **exceljs** (JavaScript) æˆ– **openpyxl** (Python)

### ç¼–è¾‘ç°æœ‰è¡¨æ ¼
ä½¿ç”¨ **openpyxl** (Python) æˆ– **exceljs** (JavaScript)

### æ•°æ®åˆ†æ
ä½¿ç”¨ **pandas** + **openpyxl**

## åˆ›å»ºæ–°è¡¨æ ¼

### æ–¹æ¡ˆä¸€ï¼šopenpyxl (Pythonï¼Œæ¨è)

```python
from openpyxl import Workbook
from openpyxl.styles import Font, Alignment, Border, Side, PatternFill
from openpyxl.utils import get_column_letter

wb = Workbook()
ws = wb.active
ws.title = "æ•°æ®è¡¨"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# è®¾ç½®è¡¨å¤´
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
headers = ['åºå·', 'åç§°', 'æ•°é‡', 'å•ä»·', 'é‡‘é¢']
header_font = Font(bold=True, color='FFFFFF')
header_fill = PatternFill(start_color='4472C4', fill_type='solid')

for col, header in enumerate(headers, 1):
    cell = ws.cell(row=1, column=col, value=header)
    cell.font = header_font
    cell.fill = header_fill
    cell.alignment = Alignment(horizontal='center')

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å¡«å……æ•°æ®
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
data = [
    [1, 'äº§å“A', 100, 25.5, '=C2*D2'],
    [2, 'äº§å“B', 200, 18.0, '=C3*D3'],
    [3, 'äº§å“C', 150, 32.0, '=C4*D4'],
]

for row_idx, row_data in enumerate(data, 2):
    for col_idx, value in enumerate(row_data, 1):
        ws.cell(row=row_idx, column=col_idx, value=value)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# æ·»åŠ æ±‡æ€»è¡Œ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ws.cell(row=5, column=4, value='åˆè®¡:')
ws.cell(row=5, column=5, value='=SUM(E2:E4)')

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# è°ƒæ•´åˆ—å®½
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
for col in range(1, 6):
    ws.column_dimensions[get_column_letter(col)].width = 12

wb.save('output.xlsx')
```

### æ–¹æ¡ˆäºŒï¼šexceljs (JavaScript)

```javascript
import ExcelJS from 'exceljs'

const workbook = new ExcelJS.Workbook()
workbook.creator = 'ä½œè€…'
workbook.created = new Date()

const sheet = workbook.addWorksheet('æ•°æ®è¡¨')

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// è®¾ç½®åˆ—å®šä¹‰
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
sheet.columns = [
  { header: 'åºå·', key: 'id', width: 10 },
  { header: 'åç§°', key: 'name', width: 20 },
  { header: 'æ•°é‡', key: 'qty', width: 12 },
  { header: 'å•ä»·', key: 'price', width: 12 },
  { header: 'é‡‘é¢', key: 'amount', width: 15 },
]

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// æ·»åŠ æ•°æ®
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
sheet.addRows([
  { id: 1, name: 'äº§å“A', qty: 100, price: 25.5, amount: { formula: 'C2*D2' } },
  { id: 2, name: 'äº§å“B', qty: 200, price: 18.0, amount: { formula: 'C3*D3' } },
  { id: 3, name: 'äº§å“C', qty: 150, price: 32.0, amount: { formula: 'C4*D4' } },
])

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// æ ·å¼è®¾ç½®
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
sheet.getRow(1).font = { bold: true, color: { argb: 'FFFFFFFF' } }
sheet.getRow(1).fill = {
  type: 'pattern',
  pattern: 'solid',
  fgColor: { argb: 'FF4472C4' }
}

await workbook.xlsx.writeFile('output.xlsx')
```

## æ•°æ®åˆ†æ

### pandas + openpyxl

```python
import pandas as pd

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# è¯»å–æ•°æ®
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
df = pd.read_excel('input.xlsx', sheet_name='Sheet1')

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# æ•°æ®å¤„ç†
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
summary = df.groupby('ç±»åˆ«').agg({
    'æ•°é‡': 'sum',
    'é‡‘é¢': ['sum', 'mean']
}).round(2)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# å¯¼å‡ºç»“æœ
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
with pd.ExcelWriter('analysis.xlsx', engine='openpyxl') as writer:
    df.to_excel(writer, sheet_name='åŸå§‹æ•°æ®', index=False)
    summary.to_excel(writer, sheet_name='æ±‡æ€»åˆ†æ')
```

## å›¾è¡¨ç”Ÿæˆ

```python
from openpyxl import Workbook
from openpyxl.chart import BarChart, Reference

wb = Workbook()
ws = wb.active

# æ•°æ®
data = [
    ['æœˆä»½', 'é”€å”®é¢'],
    ['1æœˆ', 1200],
    ['2æœˆ', 1500],
    ['3æœˆ', 1800],
]
for row in data:
    ws.append(row)

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# åˆ›å»ºæŸ±çŠ¶å›¾
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
chart = BarChart()
chart.title = "æœˆåº¦é”€å”®é¢"
chart.x_axis.title = "æœˆä»½"
chart.y_axis.title = "é‡‘é¢"

data_ref = Reference(ws, min_col=2, min_row=1, max_row=4)
cats_ref = Reference(ws, min_col=1, min_row=2, max_row=4)

chart.add_data(data_ref, titles_from_data=True)
chart.set_categories(cats_ref)

ws.add_chart(chart, "D2")
wb.save('chart.xlsx')
```

## å…¬å¼é‡ç®—

ç¼–è¾‘ xlsx åéœ€è¦é‡ç®—å…¬å¼æ—¶ï¼Œè¿è¡Œï¼š

```bash
python scripts/recalc.py input.xlsx output.xlsx
```

## å¸¸ç”¨å…¬å¼

| åŠŸèƒ½ | å…¬å¼ |
|-----|------|
| æ±‚å’Œ | `=SUM(A1:A10)` |
| å¹³å‡ | `=AVERAGE(A1:A10)` |
| è®¡æ•° | `=COUNT(A1:A10)` |
| æ¡ä»¶æ±‚å’Œ | `=SUMIF(A:A,"æ¡ä»¶",B:B)` |
| æŸ¥æ‰¾ | `=VLOOKUP(æŸ¥æ‰¾å€¼,èŒƒå›´,åˆ—å·,FALSE)` |
| æ¡ä»¶åˆ¤æ–­ | `=IF(æ¡ä»¶,çœŸå€¼,å‡å€¼)` |

## ä¾èµ–

```bash
# Python
pip install openpyxl pandas

# JavaScript
npm install exceljs
```
