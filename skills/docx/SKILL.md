---
name: Wordæ–‡æ¡£åŠ©æ‰‹
description: "æ™ºèƒ½æ–‡æ¡£ç¼–è¾‘åŠ©æ‰‹ï¼Œæ”¯æŒç»“æ„åŒ–å†™ä½œã€å¤šè½®ä¿®æ”¹ã€æ ¼å¼è°ƒæ•´å’Œå‚è€ƒå­¦ä¹ "
license: Proprietary. LICENSE.txt has complete terms
icon: ğŸ“
category: åŠå…¬
---

# DOCX æ™ºèƒ½ç¼–è¾‘åŠ©æ‰‹

## æ ¸å¿ƒåŸåˆ™

1. **ä¿®è®¢æ¨¡å¼é»˜è®¤å¼€å¯**: æ‰€æœ‰ç¼–è¾‘æ“ä½œè‡ªåŠ¨ä½¿ç”¨ Word ä¿®è®¢è¿½è¸ª
2. **å¢é‡ä¿®æ”¹ä¼˜å…ˆ**: åªä¿®æ”¹éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œä¿ç•™åŸæ–‡æ¡£å®Œæ•´æ€§
3. **ä¸»åŠ¨æ¾„æ¸…éœ€æ±‚**: ä¸ç¡®å®šæ—¶å…ˆé—®ï¼Œä¸è¦çŒœæµ‹ç”¨æˆ·æ„å›¾

---

## ä¸‰é˜¶æ®µå·¥ä½œæµ

### é˜¶æ®µä¸€ï¼šéœ€æ±‚ç†è§£

åœ¨å¼€å§‹ä»»ä½•æ“ä½œå‰ï¼Œå¿…é¡»ï¼š

**1. è¯†åˆ«ä»»åŠ¡ç±»å‹**
- åˆ›å»ºæ–°æ–‡æ¡£
- ç¼–è¾‘ç°æœ‰æ–‡æ¡£
- æ ¼å¼è°ƒæ•´
- å†…å®¹å®¡æ ¸

**2. ä¸»åŠ¨æ¾„æ¸…ä¸æ˜ç¡®çš„éœ€æ±‚**

å½“éœ€æ±‚ä¸å¤Ÿæ˜ç¡®æ—¶ï¼Œä½¿ç”¨ä»¥ä¸‹æ¨¡æ¿ï¼š

```
ä¸ºäº†æ›´å¥½åœ°å¸®åŠ©æ‚¨ï¼Œæˆ‘éœ€è¦ç¡®è®¤å‡ ä¸ªé—®é¢˜ï¼š

1. [å…³äºæ–‡æ¡£ç»“æ„/å†…å®¹çš„é—®é¢˜]
2. [å…³äºé£æ ¼/è¯­æ°”çš„é—®é¢˜]
3. [å…³äºæ ¼å¼è¦æ±‚çš„é—®é¢˜]

æ‚¨å¯ä»¥ç›´æ¥å›ç­”ï¼Œæˆ–è€…è¯´"æŒ‰ä½ çš„ç†è§£æ¥"ã€‚
```

**3. ç¡®è®¤ç†è§£åå†æ‰§è¡Œ**

```
å¥½çš„ï¼Œæˆ‘ç†è§£æ‚¨çš„éœ€æ±‚æ˜¯ï¼š
- [éœ€æ±‚ç‚¹1]
- [éœ€æ±‚ç‚¹2]

æˆ‘å°†æŒ‰ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼š
1. [æ­¥éª¤1]
2. [æ­¥éª¤2]

å¦‚æœç†è§£æœ‰è¯¯ï¼Œè¯·å‘Šè¯‰æˆ‘ã€‚
```

### é˜¶æ®µäºŒï¼šæ–‡æ¡£æ“ä½œ

#### åˆ›å»ºæ–°æ–‡æ¡£
ä½¿ç”¨ docx-jsï¼Œå‚è€ƒ [`docx-js.md`](docx-js.md)

#### ç¼–è¾‘ç°æœ‰æ–‡æ¡£ï¼ˆé»˜è®¤ä½¿ç”¨ä¿®è®¢æ¨¡å¼ï¼‰

1. è·å–å½“å‰çŠ¶æ€ï¼š`pandoc --track-changes=all doc.docx -o current.md`
2. åˆ†æéœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†
3. ä½¿ç”¨ Document åº“è¿›è¡Œå¢é‡ä¿®æ”¹
4. æ¯æ¬¡ä¿®æ”¹åéªŒè¯ç»“æœ

#### æ ¼å¼è°ƒæ•´
æ”¯æŒï¼šå­—ä½“ã€å­—å·ã€å¯¹é½ã€è¡Œè·ã€ç¼©è¿›ã€æ ·å¼åº”ç”¨

### é˜¶æ®µä¸‰ï¼šç»“æœå‘ˆç°

æ¯æ¬¡ä¿®æ”¹å®Œæˆåï¼Œå¿…é¡»ï¼š

**1. ç”Ÿæˆä¿®æ”¹æ‘˜è¦**
```
## ä¿®æ”¹æ‘˜è¦

æœ¬æ¬¡ä¿®æ”¹å…±æ¶‰åŠ N å¤„å˜æ›´ï¼š

1. [ä½ç½®]: [åŸå†…å®¹] â†’ [æ–°å†…å®¹]
2. [ä½ç½®]: [åŸå†…å®¹] â†’ [æ–°å†…å®¹]
```

**2. è¯¢é—®åç»­éœ€æ±‚**
```
æ–‡æ¡£å·²æ›´æ–°ã€‚æ‚¨å¯ä»¥ï¼š
- ç»§ç»­ä¿®æ”¹å…¶ä»–éƒ¨åˆ†
- è°ƒæ•´åˆšæ‰çš„ä¿®æ”¹
- ç¡®è®¤å®Œæˆ
```

---

## å‚è€ƒæ–‡ä»¶å¤„ç†

å½“ç”¨æˆ·æä¾›å‚è€ƒæ–‡ä»¶æˆ–ç½‘å€æ—¶ï¼š

### é£æ ¼å­¦ä¹ 
1. åˆ†æç»“æ„ç‰¹å¾ï¼ˆæ ‡é¢˜å±‚çº§ã€æ®µè½ç»„ç»‡ï¼‰
2. è¯†åˆ«å†™ä½œé£æ ¼ï¼ˆæ­£å¼/éæ­£å¼ã€ç®€æ´/è¯¦ç»†ï¼‰
3. è®°å½•æ ¼å¼è§„èŒƒï¼ˆå­—ä½“ã€é—´è·ã€å¯¹é½ï¼‰
4. åœ¨åˆ›å»º/ç¼–è¾‘æ—¶åº”ç”¨è¿™äº›ç‰¹å¾

### å†…å®¹æå–
1. æå–å…³é”®ä¿¡æ¯
2. æ•´åˆåˆ°ç›®æ ‡æ–‡æ¡£ä¸­
3. æ ‡æ³¨ä¿¡æ¯æ¥æº

---

## æŠ€æœ¯å®ç°ç»†èŠ‚

### Reading/Analyzing Content

#### Text extraction
è½¬æ¢æ–‡æ¡£ä¸º markdownï¼š
```bash
pandoc --track-changes=all path-to-file.docx -o output.md
# Options: --track-changes=accept/reject/all
```

#### Raw XML access
éœ€è¦åŸå§‹ XML è®¿é—®çš„åœºæ™¯ï¼šcomments, complex formatting, document structure, embedded media, metadata

**Unpacking a file**
`python ooxml/scripts/unpack.py <office_file> <output_directory>`

**Key file structures**
* `word/document.xml` - Main document contents
* `word/comments.xml` - Comments referenced in document.xml
* `word/media/` - Embedded images and media files
* Tracked changes use `<w:ins>` (insertions) and `<w:del>` (deletions) tags

### Creating a new Word document

ä½¿ç”¨ **docx-js** åˆ›å»ºæ–°æ–‡æ¡£ã€‚

**Workflow**
1. **MANDATORY - READ ENTIRE FILE**: Read [`docx-js.md`](docx-js.md) (~500 lines) completely
2. Create a JavaScript/TypeScript file using Document, Paragraph, TextRun components
3. Export as .docx using Packer.toBuffer()

### Editing an existing Word document

ä½¿ç”¨ **Document library** (Python library for OOXML manipulation)ã€‚

**Workflow**
1. **MANDATORY - READ ENTIRE FILE**: Read [`ooxml.md`](ooxml.md) (~600 lines) completely
2. Unpack the document: `python ooxml/scripts/unpack.py <office_file> <output_directory>`
3. Create and run a Python script using the Document library
4. Pack the final document: `python ooxml/scripts/pack.py <input_directory> <office_file>`

---

## Redlining å·¥ä½œæµ

**Batching Strategy**: Group related changes into batches of 3-10 changes.

**Principle: Minimal, Precise Edits**
åªæ ‡è®°å®é™…å˜æ›´çš„æ–‡æœ¬ã€‚å°†æ›¿æ¢æ‹†åˆ†ä¸ºï¼š[unchanged text] + [deletion] + [insertion] + [unchanged text]

Example - Changing "30 days" to "60 days":
```python
# BAD - Replaces entire sentence
'<w:del><w:r><w:delText>The term is 30 days.</w:delText></w:r></w:del><w:ins><w:r><w:t>The term is 60 days.</w:t></w:r></w:ins>'

# GOOD - Only marks what changed
'<w:r w:rsidR="00AB12CD"><w:t>The term is </w:t></w:r><w:del><w:r><w:delText>30</w:delText></w:r></w:del><w:ins><w:r><w:t>60</w:t></w:r></w:ins><w:r w:rsidR="00AB12CD"><w:t> days.</w:t></w:r>'
```

### Tracked changes workflow

1. **Get markdown representation**:
   ```bash
   pandoc --track-changes=all path-to-file.docx -o current.md
   ```

2. **Identify and group changes**: Organize into logical batches

   **Location methods**:
   - Section/heading numbers
   - Paragraph identifiers if numbered
   - Grep patterns with unique surrounding text
   - Document structure
   - **DO NOT use markdown line numbers**

3. **Read documentation and unpack**:
   - Read [`ooxml.md`](ooxml.md) completely
   - `python ooxml/scripts/unpack.py <file.docx> <dir>`

4. **Implement changes in batches**: Use `get_node` to find nodes, implement changes, then `doc.save()`

5. **Pack the document**:
   ```bash
   python ooxml/scripts/pack.py unpacked reviewed-document.docx
   ```

6. **Final verification**:
   ```bash
   pandoc --track-changes=all reviewed-document.docx -o verification.md
   ```

---

## Converting Documents to Images

```bash
# Convert DOCX to PDF
soffice --headless --convert-to pdf document.docx

# Convert PDF pages to JPEG images
pdftoppm -jpeg -r 150 document.pdf page
```

Options:
- `-r 150`: Resolution 150 DPI
- `-f N`: First page
- `-l N`: Last page

---

## Code Style Guidelines

- Write concise code
- Avoid verbose variable names and redundant operations
- Avoid unnecessary print statements

## Dependencies

- **pandoc**: `sudo apt-get install pandoc`
- **docx**: `npm install -g docx`
- **LibreOffice**: `sudo apt-get install libreoffice`
- **Poppler**: `sudo apt-get install poppler-utils`
- **defusedxml**: `pip install defusedxml`
