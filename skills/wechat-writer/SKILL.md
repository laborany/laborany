---
name: 公众号写作助手
description: 微信公众号文章全流程创作技能。从选题构思到成稿排版的一站式写作助手，内置 Dan Koe 风格写作框架、AI痕迹智能去除、公众号专业排版输出。当用户需要撰写公众号文章、优化文章风格或排版输出时使用。
icon: ✍️
category: 创作
---

# 公众号写作助手

微信公众号文章全流程创作：选题写作 → 去AI味 → 排版输出。

## 工作流程概览

```
用户需求 → 阶段一：选题与写作 → 阶段二：去除AI味 → 阶段三：排版输出 → .html 文件
```

---

## 阶段一：选题与写作

### 步骤

1. **接收需求**：理解用户的写作主题、目标受众、核心观点
2. **信息补充**：如涉及新产品/技术，搜索相关信息补充背景
3. **选题方向**：提供 3-4 个选题方向（含标题 + 角度 + 预期受众）
4. **⏸ 等待用户确认选题**
5. **选择风格**：展示 `writers/` 目录下可用的写作风格
6. **⏸ 等待用户选择风格**（默认 Dan Koe）
7. **加载风格**：读取对应风格文件（如 `writers/dan-koe.md`），学习写作框架
8. **创作初稿**：按风格指南的文章结构完成初稿
9. **三遍审校**：
   - 第一遍：结构与逻辑（段落衔接、论点支撑）
   - 第二遍：风格与语感（是否符合所选风格要求）
   - 第三遍：细节与打磨（错别字、标点、格式）
10. **保存初稿**：输出为 Markdown 文件

### 写作风格速查

当前内置风格：

| 风格 | 文件 | 特点 |
|------|------|------|
| Dan Koe | `writers/dan-koe.md` | 深刻犀利、接地气、六段式结构 |

> 添加新风格：在 `writers/` 目录下新增 `.md` 文件即可，无需修改本文件。
> 风格文件应包含：核心DNA、文章结构、标题公式、格式规范、语气要求。

### Dan Koe 风格核心DNA

- 身份优先于行动：改变从认知开始
- 所有行为都有目的：拖延是保护机制
- 反对盲目专精：多元兴趣是超能力
- 写作即思考：表达不清说明没想清楚
- 像朋友聊天，不像老师讲课

六段式结构：钩子开场 → 痛点共鸣 → 价值承诺 → 核心内容 → 金句提炼 → 赋权结尾

---

## 阶段二：去除AI味

### 步骤

1. **加载指南**：读取 `references/humanizer.md`
2. **逐段扫描**：识别 24 种 AI 写作模式
3. **核心原则**：只改表达，不改逻辑和结构
4. **重写片段**：修正有 AI 痕迹的段落
5. **质量评分**：五维评分（直接性/节奏/信任度/真实性/精炼度，满分50）
6. **自动迭代**：若评分 < 35，自动进行第二轮修正
7. **更新文件**：覆盖保存 Markdown 文件

### 核心原则速查

1. **删除填充词**：去掉"此外""值得注意的是""在当今社会"等空洞短语
2. **打破机械节奏**：长短句交错，避免每段结构相同
3. **消除过度解释**：信任读者智慧，点到为止
4. **注入个人视角**：用"我"替代"我们"，加入真实经历
5. **避免通用结论**：删除"总之""综上所述"等套话式收尾

### 五维评分体系

| 维度 | 满分 | 评判标准 |
|------|------|----------|
| 直接性 | 10 | 直截了当 vs 充满铺垫 |
| 节奏 | 10 | 长短交错 vs 机械重复 |
| 信任度 | 10 | 简洁明了 vs 过度解释 |
| 真实性 | 10 | 自然流畅 vs 机械生硬 |
| 精炼度 | 10 | 无冗余 vs 大量废话 |

- 45-50 分：优秀
- 35-44 分：良好
- < 35 分：需要重新修订

---

## 阶段三：排版输出

### 步骤

1. **加载规范**：读取 `references/html-guide.md` + `references/themes.md`
2. **展示主题**：列出可用排版主题
3. **⏸ 等待用户选择主题**
4. **生成HTML**：按微信HTML规范将 Markdown 转换为公众号兼容 HTML
5. **应用样式**：按选定主题生成内联CSS
6. **保存文件**：输出 `{标题}.html` 到工作目录
7. **预览提示**：用户可在预览面板直接查看排版效果

### 可用主题

| 主题 | 风格 | 适合内容 |
|------|------|----------|
| 🟠 秋日暖光 | 温暖治愈，橙色调 | 情感故事、生活随笔 |
| 🟢 春日清新 | 清新自然，绿色调 | 旅行日记、自然主题 |
| 🔵 深海静谧 | 深邃冷静，蓝色调 | 技术文章、商业分析 |

### 微信HTML关键约束

- 所有CSS必须内联（`style` 属性），微信不支持 `<style>` 标签
- `<body>` 样式会被剥离，必须用主 `<div>` 容器承载全局样式
- 每个 `<p>` 必须显式指定 `color`，否则被重置为黑色
- 禁止使用 flexbox、grid、position:absolute/fixed、animation
- 图片必须使用微信 CDN 域名

---

## 输出文件

每次完整执行产出两个文件：

| 文件 | 格式 | 用途 |
|------|------|------|
| `{标题}.md` | Markdown | 原始内容，可二次编辑 |
| `{标题}.html` | HTML | 排版成品，可直接粘贴到公众号编辑器 |

---

## 快捷用法

支持跳过某些阶段，直接执行特定任务：

| 用户说 | 执行阶段 |
|--------|----------|
| "写一篇关于XX的公众号文章" | 阶段一 → 二 → 三（完整流程） |
| "用 Dan Koe 风格写XX" | 阶段一（指定风格） → 二 → 三 |
| "去除这篇文章的AI味" | 仅阶段二 |
| "把这个 Markdown 排版成公众号格式" | 仅阶段三 |
| "用秋日暖光主题排版" | 仅阶段三（指定主题） |

---

## 风格扩展指南

### 添加新写作风格

1. 在 `writers/` 目录下创建 `{风格名}.md` 文件
2. 文件应包含以下部分：
   - 核心写作DNA（3-5条信念）
   - 文章结构模板（含每部分的写作指导）
   - 标题公式库（含示例）
   - 格式规范（段落/标记/标点）
   - 语气要求（要做到 vs 要避免）
3. 无需修改 SKILL.md，技能会自动扫描 `writers/` 目录

### 风格文件命名规范

- 使用小写英文 + 连字符：`paul-graham.md`、`naval.md`
- 文件开头注明风格名称和一句话描述

---

## 参考文件索引

| 文件 | 内容 | 加载时机 |
|------|------|----------|
| `writers/dan-koe.md` | Dan Koe 写作风格完整指南 | 阶段一：选择该风格时 |
| `references/humanizer.md` | 24种AI模式识别与修正指南 | 阶段二：去AI味时 |
| `references/html-guide.md` | 微信公众号HTML技术规范 | 阶段三：排版时 |
| `references/themes.md` | 排版主题定义与样式模板 | 阶段三：选择主题时 |
